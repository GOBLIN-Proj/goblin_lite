<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>goblin_lite.scenario_analysis.data_grapher &mdash; GOBLIN lite 0.4.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=c87aa342"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            GOBLIN lite
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../INSTALLATION.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../example.html">Example Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../CONTRIBUTING.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">GOBLIN lite</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">goblin_lite.scenario_analysis.data_grapher</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for goblin_lite.scenario_analysis.data_grapher</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Data Grapher Module</span>
<span class="sd">====================</span>

<span class="sd">The Data Grapher module is an experimental tool designed to visualize various environmental data sets. It primarily serves as a visualization aid, assisting users in interpreting complex environmental data through graphical representations. </span>
<span class="sd">The module leverages data obtained from the DataFetcher class and provides functionalities to create diverse plots for different scenarios.</span>

<span class="sd">This module is still under development and may not function as intended in all situations. </span>
<span class="sd">Users are encouraged to use this module as a basis for further customization and to adapt it to their specific data visualization needs.</span>

<span class="sd">Class Overview</span>
<span class="sd">--------------</span>
<span class="sd">The DataGrapher class offers methods to plot data related to crop and livestock life cycle assessment (LCA) emissions, land use emissions, forest carbon flux, and more. </span>
<span class="sd">Each method is tailored to visualize specific types of data, providing insights into environmental impacts across various scenarios.</span>

<span class="sd">The class is designed to be flexible and user-friendly, allowing for easy integration with existing data analysis workflows. </span>
<span class="sd">It is particularly useful for environmental researchers, policy makers, and analysts who require visual representations of data to support their work.</span>

<span class="sd">Attributes</span>
<span class="sd">----------</span>
<span class="sd">- None: The class does not require initialization with specific attributes.</span>

<span class="sd">Methods</span>
<span class="sd">-------</span>
<span class="sd">- plot_crop_livestock_lca_emissions_by_category(path): Visualizes combined crop and livestock LCA emissions by category for different scenarios.</span>
<span class="sd">- plot_crop_lca_emissions_by_category(path): Displays crop LCA emissions by category for various scenarios.</span>
<span class="sd">- plot_animal_lca_emissions_by_category(path): Shows livestock LCA emissions by category across different scenarios.</span>
<span class="sd">- plot_land_use_emissions(path): Creates plots for land-use emissions by gas for each scenario.</span>
<span class="sd">- plot_forest_flux(path, detail=False): Visualizes forest carbon annual flux for different scenarios.</span>
<span class="sd">- plot_forest_aggregate(path, detail=False): Depicts aggregated forest carbon data over time.</span>
<span class="sd">- plot_forest_flux_subplot(path): Generates subplots of forest carbon annual flux for each scenario.</span>
<span class="sd">- get_combined_crop_and_livestock_pathway_frames(): Retrieves combined dataframes for crop and livestock pathway emissions.</span>
<span class="sd">- rank_chart(target, gas, path): Creates a scatter plot showing the ranking and percentage change in GHG, ammonia, eutrophication, and protein output from the baseline.</span>

<span class="sd">Usage</span>
<span class="sd">-----</span>
<span class="sd">To use the DataGrapher class, simply create an instance of the class and call the desired plotting method with the appropriate parameters. </span>
<span class="sd">The methods will generate plots based on the provided data and save them to the specified file path.</span>

<span class="sd">Example:</span>
<span class="sd">    &gt;&gt;&gt; data_grapher = DataGrapher()</span>
<span class="sd">    &gt;&gt;&gt; data_grapher.plot_crop_livestock_lca_emissions_by_category(&quot;output/path&quot;)</span>

<span class="sd">Note</span>
<span class="sd">----</span>
<span class="sd">- This module is experimental and may not cover all possible scenarios or data types. Users may need to modify or extend the module&#39;s capabilities to suit their specific requirements.</span>
<span class="sd">- The module relies on data provided by the DataFetcher class. Ensure that the data is correctly formatted and available before using the plotting methods.</span>
<span class="sd">- The plots generated by this module are intended for data visualization and should be interpreted cautiously, especially in the context of complex environmental data.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">goblin_lite.resource_manager.data_fetcher</span> <span class="kn">import</span> <span class="n">DataFetcher</span>
<span class="kn">from</span> <span class="nn">scenario_assessment.filter</span> <span class="kn">import</span> <span class="n">FilterResults</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">math</span>


<div class="viewcode-block" id="DataGrapher">
<a class="viewcode-back" href="../../../autoapi/goblin_lite/scenario_analysis/data_grapher/index.html#goblin_lite.scenario_analysis.data_grapher.DataGrapher">[docs]</a>
<span class="k">class</span> <span class="nc">DataGrapher</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class used to organize methods for data visualization. The current collection is relatively limited, however, utilization of the</span>
<span class="sd">    DataFetcher class will allow users to output dataframes and easily construct their plots.</span>

<span class="sd">    Though this class is still very much in development, it should still provide inspiration for various plotting pathways.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    DATABASE_PATH : str, optional</span>
<span class="sd">        Path to the external database, if None, default internal database used.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    plot_crop_livestock_lca_emissions_by_category(path):</span>
<span class="sd">        Plot combined crop and livestock life cycle assessment (LCA) emissions by category for different scenarios.</span>

<span class="sd">    plot_crop_lca_emissions_by_category(path):</span>
<span class="sd">        Plot crop LCA emissions by category (CO2E, NH3, and PO4E) for different scenarios.</span>

<span class="sd">    plot_animal_lca_emissions_by_category(path):</span>
<span class="sd">        Plot livestock LCA emissions by category (CO2E, NH3, and PO4E) for different scenarios.</span>

<span class="sd">    plot_land_use_emissions(path):</span>
<span class="sd">        Plot land-use emissions by gas (CO2, CH4, N2O) for different scenarios.</span>

<span class="sd">    plot_forest_flux(path, detail=False):</span>
<span class="sd">        Plot forest carbon annual flux (tons of carbon) for different scenarios.</span>

<span class="sd">    plot_forest_aggregate(path, detail=False):</span>
<span class="sd">        Plot aggregated forest carbon (tons of carbon) for different scenarios.</span>

<span class="sd">    plot_forest_flux_subplot(path):</span>
<span class="sd">        Plot multiple subplots of forest carbon annual flux (tons of carbon) for each scenario.</span>

<span class="sd">    get_combined_crop_and_livestock_pathway_frames():</span>
<span class="sd">        Get combined dataframes for crop and livestock pathway emissions.</span>

<span class="sd">    rank_chart(target, gas, path):</span>
<span class="sd">        Plot a scatter plot of ranking and percentage change in greenhouse gas (GHG), ammonia, eutrophication, and protein output from the baseline.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DATABASE_PATH</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span> <span class="o">=</span> <span class="n">DataFetcher</span><span class="p">(</span><span class="n">DATABASE_PATH</span><span class="p">)</span>

<div class="viewcode-block" id="DataGrapher.plot_crop_livestock_lca_emissions_by_category">
<a class="viewcode-back" href="../../../autoapi/goblin_lite/scenario_analysis/data_grapher/index.html#goblin_lite.scenario_analysis.data_grapher.DataGrapher.plot_crop_livestock_lca_emissions_by_category">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_crop_livestock_lca_emissions_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot combined crop and livestock life cycle assessment (LCA) emissions by category for different scenarios.</span>

<span class="sd">        This method generates a bar plot to visualize the emissions from combined crop and livestock activities for different scenarios. The emissions are</span>
<span class="sd">        categorized into different components, such as manure management, enteric emissions, emissions from grassland soils, and emissions from crop soils.</span>
<span class="sd">        Each component is represented by a different color for easy identification.</span>

<span class="sd">        The bar plot is organized into three subplots, each corresponding to a different environmental impact category: climate change, air quality, and eutrophication.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            path (str): The file path where the plot will be saved, including the file name and a legal format (e.g., png, jpg).</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: The plot is saved as an image file in the specified file path.</span>

<span class="sd">        Note:</span>
<span class="sd">            The method utilizes the `DataFetcher` class to retrieve dataframes containing emissions data. It calls the `get_combined_crop_and_livestock_pathway_frames()`</span>
<span class="sd">            method to obtain the necessary data for plotting.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; data_grapher = DataGrapher()</span>
<span class="sd">            &gt;&gt;&gt; data_grapher.plot_crop_livestock_lca_emissions_by_category(&quot;path/to/directory&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;manure_management&quot;</span><span class="p">:</span> <span class="s2">&quot;royalblue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;enteric&quot;</span><span class="p">:</span> <span class="s2">&quot;indianred&quot;</span><span class="p">,</span>
            <span class="s2">&quot;grassland_soils&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span>
            <span class="s2">&quot;crop_soils&quot;</span><span class="p">:</span> <span class="s2">&quot;darkorange&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_combined_crop_and_livestock_pathway_frames</span><span class="p">()</span>

        <span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

        <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Climate Change&quot;</span><span class="p">,</span> <span class="s2">&quot;CO2e kt&quot;</span><span class="p">],</span>
            <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Air Quality&quot;</span><span class="p">,</span> <span class="s2">&quot;NH3 kt&quot;</span><span class="p">],</span>
            <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Eutrophication&quot;</span><span class="p">,</span> <span class="s2">&quot;PO4e kt&quot;</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames</span><span class="p">):</span>
            <span class="n">plot_legend</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># set plot_legend to False for all plots except one</span>

            <span class="c1"># create a dictionary of category-to-column mappings</span>
            <span class="n">category_to_col</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">category_to_col</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
                    <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">category</span><span class="p">])</span>

            <span class="n">ax</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">plot_legend</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param_dict</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xlabels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">360</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Scenario&quot;</span><span class="p">)</span>

            <span class="c1"># create legend with all categories</span>
            <span class="k">if</span> <span class="n">category_to_col</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
                    <span class="n">category_to_col</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
                    <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;Crop_and_Livestock_LCA.png&quot;</span><span class="p">),</span>
            <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataGrapher.plot_crop_lca_emissions_by_category">
<a class="viewcode-back" href="../../../autoapi/goblin_lite/scenario_analysis/data_grapher/index.html#goblin_lite.scenario_analysis.data_grapher.DataGrapher.plot_crop_lca_emissions_by_category">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_crop_lca_emissions_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot crop life cycle assessment (LCA) emissions by category for different scenarios.</span>

<span class="sd">        This method generates a bar plot to visualize the emissions from crop activities for different scenarios. The emissions are</span>
<span class="sd">        categorized into different components, such as emissions from soils. Each component is represented by a different color for easy identification.</span>

<span class="sd">        The bar plot is organized into three subplots, each corresponding to a different environmental impact category: climate change, air quality, and eutrophication.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            path (str): The file path where the plot will be saved, including the file name and a legal format (e.g., png, jpg).</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: The plot is saved as an image file in the specified file path.</span>

<span class="sd">        Note:</span>
<span class="sd">            The method utilizes the `DataFetcher` class to retrieve dataframes containing emissions data. It calls the necessary methods from `DataFetcher`</span>
<span class="sd">            (e.g., `get_crop_emissions_by_category_co2e`, `get_eutrophication_crop_emissions_by_category`, and `get_air_quality_crop_emissions_by_category`)</span>
<span class="sd">            to obtain the necessary data for plotting.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; data_grapher = DataGrapher()</span>
<span class="sd">            &gt;&gt;&gt; data_grapher.plot_crop_lca_emissions_by_category(&quot;path/to/directory&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;soils&quot;</span><span class="p">:</span> <span class="s2">&quot;darkorange&quot;</span><span class="p">}</span>

        <span class="n">climate_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_crop_emissions_by_category_co2e</span><span class="p">()</span>
        <span class="n">climate_change</span> <span class="o">=</span> <span class="n">climate_change</span><span class="p">[[</span><span class="s2">&quot;soils&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">eutrophication</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_eutrophication_crop_emissions_by_category</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">air_quality</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_air_quality_crop_emissions_by_category</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">climate_change</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">climate_change</span><span class="p">,</span> <span class="n">air_quality</span><span class="p">,</span> <span class="n">eutrophication</span><span class="p">]</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

        <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Climate Change&quot;</span><span class="p">,</span> <span class="s2">&quot;CO2e kt&quot;</span><span class="p">],</span>
            <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Air Quality&quot;</span><span class="p">,</span> <span class="s2">&quot;NH3 kt&quot;</span><span class="p">],</span>
            <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Eutrophication&quot;</span><span class="p">,</span> <span class="s2">&quot;PO4e kt&quot;</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames</span><span class="p">):</span>
            <span class="n">plot_legend</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># set plot_legend to False for all plots except one</span>

            <span class="c1"># create a dictionary of category-to-column mappings</span>
            <span class="n">category_to_col</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">category_to_col</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
                    <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">category</span><span class="p">])</span>

            <span class="n">ax</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">plot_legend</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param_dict</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xlabels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">360</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Scenario&quot;</span><span class="p">)</span>

            <span class="c1"># create legend with all categories</span>
            <span class="k">if</span> <span class="n">category_to_col</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
                    <span class="n">category_to_col</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
                    <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;Crop_LCA.png&quot;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataGrapher.plot_animal_lca_emissions_by_category">
<a class="viewcode-back" href="../../../autoapi/goblin_lite/scenario_analysis/data_grapher/index.html#goblin_lite.scenario_analysis.data_grapher.DataGrapher.plot_animal_lca_emissions_by_category">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_animal_lca_emissions_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot animal life cycle assessment (LCA) emissions by category for different scenarios.</span>

<span class="sd">        This method generates a bar plot to visualize the emissions from animal-related activities for different scenarios. The emissions are</span>
<span class="sd">        categorized into different components, such as emissions from manure management and enteric fermentation. Each component is represented</span>
<span class="sd">        by a different color for easy identification.</span>

<span class="sd">        The bar plot is organized into three subplots, each corresponding to a different environmental impact category: climate change, air quality, and eutrophication.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            path (str): The file path where the plot will be saved, including the file name and a legal format (e.g., png, jpg).</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: The plot is saved as an image file in the specified file path.</span>

<span class="sd">        Note:</span>
<span class="sd">            The method utilizes the `DataFetcher` class to retrieve dataframes containing emissions data. It calls the necessary methods from `DataFetcher`</span>
<span class="sd">            (e.g., `get_animal_emissions_by_category_co2e`, `get_eutrophication_animal_emissions_by_category`, and `get_air_quality_animal_emissions_by_category`)</span>
<span class="sd">            to obtain the necessary data for plotting.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; data_grapher = DataGrapher()</span>
<span class="sd">            &gt;&gt;&gt; data_grapher.plot_animal_lca_emissions_by_category(&quot;path/to/directory&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">categories</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;manure_management&quot;</span><span class="p">:</span> <span class="s2">&quot;royalblue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;enteric&quot;</span><span class="p">:</span> <span class="s2">&quot;indianred&quot;</span><span class="p">,</span>
            <span class="s2">&quot;soils&quot;</span><span class="p">:</span> <span class="s2">&quot;darkorange&quot;</span><span class="p">,</span>
            <span class="s2">&quot;upstream&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">climate_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_animal_emissions_by_category_co2e</span><span class="p">()</span>
        <span class="n">eutrophication</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_eutrophication_animal_emissions_by_category</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">air_quality</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_air_quality_animal_emissions_by_category</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">climate_change</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">climate_change</span><span class="p">,</span> <span class="n">air_quality</span><span class="p">,</span> <span class="n">eutrophication</span><span class="p">]</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

        <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Climate Change&quot;</span><span class="p">,</span> <span class="s2">&quot;CO2e kt&quot;</span><span class="p">],</span>
            <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Air Quality&quot;</span><span class="p">,</span> <span class="s2">&quot;NH3 kt&quot;</span><span class="p">],</span>
            <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Eutrophication&quot;</span><span class="p">,</span> <span class="s2">&quot;PO4e kt&quot;</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames</span><span class="p">):</span>
            <span class="n">plot_legend</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># set plot_legend to False for all plots except one</span>

            <span class="c1"># create a dictionary of category-to-column mappings</span>
            <span class="n">category_to_col</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">category_to_col</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
                    <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">category</span><span class="p">])</span>

            <span class="n">ax</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">plot_legend</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param_dict</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xlabels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">360</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Scenario&quot;</span><span class="p">)</span>

            <span class="c1"># create legend with all categories</span>
            <span class="k">if</span> <span class="n">category_to_col</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
                    <span class="n">category_to_col</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
                    <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;Livestock_LCA.png&quot;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataGrapher.plot_land_use_emissions">
<a class="viewcode-back" href="../../../autoapi/goblin_lite/scenario_analysis/data_grapher/index.html#goblin_lite.scenario_analysis.data_grapher.DataGrapher.plot_land_use_emissions">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_land_use_emissions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot land use emissions for different gases and scenarios.</span>

<span class="sd">        This method generates a set of stacked bar plots to visualize the land use emissions for different gases and scenarios.</span>
<span class="sd">        The emissions are categorized by different land use types (e.g., forests, croplands, grasslands).</span>

<span class="sd">        The bar plots are organized in a 2x2 grid, with each plot representing a different gas: CO2, CH4, N2O, and F-gases.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            path (str): The file path where the plot will be saved, including the file name and a legal format (e.g., png, jpg).</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: The plot is saved as an image file in the specified file path.</span>

<span class="sd">        Note:</span>
<span class="sd">            The method utilizes the `DataFetcher` class to retrieve dataframes containing land use emissions data.</span>
<span class="sd">            It calls the necessary methods from `DataFetcher` (e.g., `get_landuse_emissions_totals`) to obtain the necessary data for plotting.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; data_grapher = DataGrapher()</span>
<span class="sd">            &gt;&gt;&gt; data_grapher.plot_land_use_emissions(&quot;path/to/directory&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">land_emissions_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_landuse_emissions_totals</span><span class="p">()</span>

        <span class="c1"># Melt data</span>

        <span class="n">land_emissions_df</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">land_emissions_df</span><span class="p">[</span><span class="s2">&quot;scenario&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">land_emissions_df</span><span class="o">.</span><span class="n">index</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">land_emissions_df</span><span class="p">[(</span><span class="n">land_emissions_df</span><span class="p">[</span><span class="s2">&quot;land_use&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;total&quot;</span><span class="p">)]</span>

        <span class="n">melted_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;land_use&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;scenario&quot;</span><span class="p">],</span>
            <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;gas&quot;</span><span class="p">,</span>
            <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;emissions&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">pivot_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
            <span class="n">melted_df</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="s2">&quot;emissions&quot;</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;scenario&quot;</span><span class="p">,</span> <span class="s2">&quot;gas&quot;</span><span class="p">],</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;land_use&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">pivot_table</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pivot_table</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;gas&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span>

            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>

            <span class="n">plot_legend</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># set plot_legend to False for all plots except one</span>

            <span class="n">pivot_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">g</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">plot_legend</span>
            <span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Scenario&quot;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Emissions in kt&quot;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span>
                <span class="nb">list</span><span class="p">(</span><span class="n">pivot_table</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;scenario&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span>
                <span class="n">rotation</span><span class="o">=</span><span class="mi">360</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="p">)</span>  <span class="c1"># create one legend outside the plot area</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;climate_change_land_use.png&quot;</span><span class="p">),</span>
            <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>



<div class="viewcode-block" id="DataGrapher.plot_forest_flux">
<a class="viewcode-back" href="../../../autoapi/goblin_lite/scenario_analysis/data_grapher/index.html#goblin_lite.scenario_analysis.data_grapher.DataGrapher.plot_forest_flux">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_forest_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot forest carbon flux over time.</span>

<span class="sd">        This method generates a line plot to visualize the forest carbon flux over time. The forest carbon flux represents</span>
<span class="sd">        the net change in carbon stored in forests over different years and scenarios.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            path (str): The file path where the plot will be saved, including the file name and a legal format (e.g., png, jpg).</span>
<span class="sd">            detail (bool, optional): If True, the plot will include additional details by plotting individual variables</span>
<span class="sd">                                    along with different scenarios. If False, the plot will only show scenarios without individual variables.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: The plot is saved as an image file in the specified file path.</span>

<span class="sd">        Note:</span>
<span class="sd">            The method utilizes the `DataFetcher` class to retrieve the forest carbon flux data.</span>
<span class="sd">            It calls the necessary methods from `DataFetcher` (e.g., `get_forest_flux`) to obtain the necessary data for plotting.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; data_grapher = DataGrapher()</span>
<span class="sd">            &gt;&gt;&gt; data_grapher.plot_forest_flux(&quot;path/to/directory&quot;, detail=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cbm_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_forest_flux</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">cbm_flux</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Scenario&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">detail</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Scenario&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Scenario&quot;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;t/Carbon&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Scenario&quot;</span><span class="p">,</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
            <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;forest_carbon_flux.png&quot;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataGrapher.plot_forest_aggregate">
<a class="viewcode-back" href="../../../autoapi/goblin_lite/scenario_analysis/data_grapher/index.html#goblin_lite.scenario_analysis.data_grapher.DataGrapher.plot_forest_aggregate">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_forest_aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot aggregated forest carbon data over time.</span>

<span class="sd">        This method generates a line plot to visualize the aggregated forest carbon data over time.</span>
<span class="sd">        The aggregated forest carbon data represents the total carbon stored in forests over different years and scenarios.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            path (str): The file path where the plot will be saved, including the file name and a legal format (e.g., png, jpg).</span>
<span class="sd">            detail (bool, optional): If True, the plot will include additional details by plotting individual variables</span>
<span class="sd">                                    along with different scenarios. If False, the plot will only show scenarios without individual variables.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: The plot is saved as an image file in the specified file path.</span>

<span class="sd">        Note:</span>
<span class="sd">            The method utilizes the `DataFetcher` class to retrieve the aggregated forest carbon data.</span>
<span class="sd">            It calls the necessary methods from `DataFetcher` (e.g., `get_forest_aggregate`) to obtain the necessary data for plotting.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; data_grapher = DataGrapher()</span>
<span class="sd">            &gt;&gt;&gt; data_grapher.plot_forest_aggregate(&quot;path/to/directory&quot;, detail=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cbm_aggregate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_forest_aggregate</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">cbm_aggregate</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Scenario&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">detail</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Scenario&quot;</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Scenario&quot;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;t/Carbon&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;forest_carbon_aggregate.png&quot;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataGrapher.plot_forest_flux_subplot">
<a class="viewcode-back" href="../../../autoapi/goblin_lite/scenario_analysis/data_grapher/index.html#goblin_lite.scenario_analysis.data_grapher.DataGrapher.plot_forest_flux_subplot">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_forest_flux_subplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot forest carbon flux data for multiple scenarios using subplots.</span>

<span class="sd">        This method generates a set of line plots arranged in subplots to visualize the forest carbon flux data</span>
<span class="sd">        for multiple scenarios over time. Each subplot represents a different scenario, and the lines in each subplot</span>
<span class="sd">        represent the carbon flux values for different variables.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            path (str): The file path where the plot will be saved, including the file name and a legal format (e.g., png, jpg).</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If there are more than 20 scenarios present in the data, as it may lead to an overcrowded plot.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: The plot is saved as an image file in the specified file path.</span>

<span class="sd">        Note:</span>
<span class="sd">            The method utilizes the `DataFetcher` class to retrieve the forest carbon flux data for multiple scenarios.</span>
<span class="sd">            It calls the necessary methods from `DataFetcher` (e.g., `get_forest_flux`) to obtain the necessary data for plotting.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; data_grapher = DataGrapher()</span>
<span class="sd">            &gt;&gt;&gt; data_grapher.plot_forest_flux_subplot(&quot;path/to/directory&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cbm_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_forest_flux</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">cbm_flux</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Scenario&quot;</span><span class="p">])</span>

        <span class="n">subplot_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Scenario&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">subplot_number</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Too many scenarios present, max = 20&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">subplot_number</span> <span class="o">/</span> <span class="n">cols</span><span class="p">)</span>

            <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

            <span class="n">scenario</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Scenario&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">scenario</span>
                    <span class="k">if</span> <span class="n">rows</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Scenario&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                            <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
                                <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">],</span>
                                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span>
                                <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span>
                                <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
                                <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span>
                                <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="p">)</span>
                            <span class="n">axes</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scenario: </span><span class="si">{</span><span class="n">scenario</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">axes</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
                            <span class="n">axes</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;t/Carbon&quot;</span><span class="p">)</span>
                            <span class="n">axes</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Scenario&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                            <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
                                <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">c</span><span class="p">],</span>
                                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span>
                                <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span>
                                <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
                                <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span>
                                <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="p">)</span>
                            <span class="n">axes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scenario: </span><span class="si">{</span><span class="n">scenario</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">axes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
                            <span class="n">axes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;t/Carbon&quot;</span><span class="p">)</span>
                            <span class="n">axes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>

                    <span class="n">scenario</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">rows</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.15</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;forest_flux_subplot.png&quot;</span><span class="p">),</span>
                <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
                <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataGrapher.get_combined_crop_and_livestock_pathway_frames">
<a class="viewcode-back" href="../../../autoapi/goblin_lite/scenario_analysis/data_grapher/index.html#goblin_lite.scenario_analysis.data_grapher.DataGrapher.get_combined_crop_and_livestock_pathway_frames">[docs]</a>
    <span class="k">def</span> <span class="nf">get_combined_crop_and_livestock_pathway_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve and combine the data related to combined crop and livestock pathway frames.</span>

<span class="sd">        This method fetches data from different sources for livestock and crop emissions related to various environmental factors.</span>
<span class="sd">        It then combines the data into three distinct dataframes: one for climate change, one for eutrophication, and one for air quality.</span>
<span class="sd">        The data is collected from the `DataFetcher` class, which provides separate methods to obtain livestock and crop emissions data</span>
<span class="sd">        for different environmental factors.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of three dataframes containing combined crop and livestock pathway data for climate change, eutrophication,</span>
<span class="sd">                and air quality, respectively.</span>

<span class="sd">        Note:</span>
<span class="sd">            The `DataFetcher` class is utilized to fetch the necessary data for livestock and crop emissions. The dataframe columns</span>
<span class="sd">            represent different environmental factors and pathways, such as &quot;manure_management,&quot; &quot;enteric,&quot; &quot;grassland_soils,&quot; and &quot;crop_soils.&quot;</span>
<span class="sd">            The data is combined appropriately into each of the three dataframes, with common columns for the respective environmental factors.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; data_grapher = DataGrapher()</span>
<span class="sd">            &gt;&gt;&gt; combined_frames = data_grapher.get_combined_crop_and_livestock_pathway_frames()</span>
<span class="sd">            &gt;&gt;&gt; climate_change_frame = combined_frames[0]</span>
<span class="sd">            &gt;&gt;&gt; eutrophication_frame = combined_frames[1]</span>
<span class="sd">            &gt;&gt;&gt; air_quality_frame = combined_frames[2]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">climate_change_livestock</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_animal_emissions_by_category_co2e</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">eutrophication_livestock</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_eutrophication_animal_emissions_by_category</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">air_quality_livestock</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_air_quality_animal_emissions_by_category</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">climate_change_crop</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_crop_emissions_by_category_co2e</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">climate_change_crop</span> <span class="o">=</span> <span class="n">climate_change_crop</span><span class="p">[[</span><span class="s2">&quot;soils&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">eutrophication_crop</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_eutrophication_crop_emissions_by_category</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">air_quality_crop</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_fetcher_class</span><span class="o">.</span><span class="n">get_air_quality_crop_emissions_by_category</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">climate_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;manure_management&quot;</span><span class="p">,</span> <span class="s2">&quot;enteric&quot;</span><span class="p">,</span> <span class="s2">&quot;grassland_soils&quot;</span><span class="p">,</span> <span class="s2">&quot;crop_soils&quot;</span><span class="p">]</span>
        <span class="n">other_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;manure_management&quot;</span><span class="p">,</span> <span class="s2">&quot;grassland_soils&quot;</span><span class="p">,</span> <span class="s2">&quot;crop_soils&quot;</span><span class="p">]</span>

        <span class="n">climate_change</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">climate_cols</span><span class="p">)</span>
        <span class="n">eutrophication</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">other_cols</span><span class="p">)</span>
        <span class="n">air_quality</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">other_cols</span><span class="p">)</span>

        <span class="n">climate_change</span><span class="p">[</span><span class="s2">&quot;manure_management&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">climate_change_livestock</span><span class="p">[</span>
            <span class="s2">&quot;manure_management&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">climate_change</span><span class="p">[</span><span class="s2">&quot;enteric&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">climate_change_livestock</span><span class="p">[</span><span class="s2">&quot;enteric&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">climate_change</span><span class="p">[</span><span class="s2">&quot;grassland_soils&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">climate_change_livestock</span><span class="p">[</span><span class="s2">&quot;soils&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">climate_change_crop</span><span class="p">[</span><span class="s2">&quot;soils&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">climate_change</span><span class="p">[</span><span class="s2">&quot;crop_soils&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">climate_change_crop</span><span class="p">[</span><span class="s2">&quot;soils&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">eutrophication</span><span class="p">[</span><span class="s2">&quot;manure_management&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eutrophication_livestock</span><span class="p">[</span>
            <span class="s2">&quot;manure_management&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">eutrophication</span><span class="p">[</span><span class="s2">&quot;grassland_soils&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eutrophication_livestock</span><span class="p">[</span><span class="s2">&quot;soils&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">eutrophication_crop</span><span class="p">[</span><span class="s2">&quot;soils&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">eutrophication</span><span class="p">[</span><span class="s2">&quot;crop_soils&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eutrophication_crop</span><span class="p">[</span><span class="s2">&quot;soils&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">air_quality</span><span class="p">[</span><span class="s2">&quot;manure_management&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">air_quality_livestock</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">:,</span> <span class="s2">&quot;manure_management&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">air_quality</span><span class="p">[</span><span class="s2">&quot;grassland_soils&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">air_quality_livestock</span><span class="p">[</span><span class="s2">&quot;soils&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">air_quality_crop</span><span class="p">[</span><span class="s2">&quot;soils&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">air_quality</span><span class="p">[</span><span class="s2">&quot;crop_soils&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">air_quality_crop</span><span class="p">[</span><span class="s2">&quot;soils&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">climate_change</span><span class="p">,</span> <span class="n">air_quality</span><span class="p">,</span> <span class="n">eutrophication</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">frames</span></div>


<div class="viewcode-block" id="DataGrapher.rank_chart">
<a class="viewcode-back" href="../../../autoapi/goblin_lite/scenario_analysis/data_grapher/index.html#goblin_lite.scenario_analysis.data_grapher.DataGrapher.rank_chart">[docs]</a>
    <span class="k">def</span> <span class="nf">rank_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">gas</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces a scatter plot that visualizes the data output from the Filter_results.search() method.</span>
<span class="sd">        The data returned from Filter_results.search() is plotted along the x and y axes. The y-axis represents the percentage change in</span>
<span class="sd">        the specific variable from the baseline, and the x-axis represents the ranking of scenarios based on the &quot;cost&quot; calculated in the</span>
<span class="sd">        Filter_results.search() method. The &quot;cost&quot; is determined by the overall impact on total livestock output (beef and milk) from the baseline.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        target : str</span>
<span class="sd">            The target scenario or variable to compare. It can be &quot;ghg&quot; (Greenhouse Gas emissions), &quot;ammonia&quot; (ammonia emissions),</span>
<span class="sd">            &quot;eutrophication&quot; (eutrophication emissions), or &quot;production&quot; (protein output).</span>

<span class="sd">        gas : str</span>
<span class="sd">            The selected gas emissions to consider. This can be &quot;CO2e&quot; (Carbon Dioxide Equivalent), &quot;NH3&quot; (ammonia), or &quot;PO4&quot; (eutrophication).</span>

<span class="sd">        path : str</span>
<span class="sd">            The file path where the scatter plot will be saved, including the file name and a legal format (e.g., png, jpg).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Scatter Plot</span>
<span class="sd">            A scatter plot representing the ranking of scenarios on the x-axis and the percentage change in the specified variable</span>
<span class="sd">            (e.g., greenhouse gas emissions, ammonia emissions, eutrophication emissions, or protein output) from the baseline on the y-axis.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; data_grapher = DataGrapher()</span>
<span class="sd">        &gt;&gt;&gt; target_variable = &quot;ghg&quot;</span>
<span class="sd">        &gt;&gt;&gt; selected_gas = &quot;CO2e&quot;</span>
<span class="sd">        &gt;&gt;&gt; plot_path = &quot;path/to/directory&quot;</span>
<span class="sd">        &gt;&gt;&gt; data_grapher.rank_chart(target_variable, selected_gas, plot_path)</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        - The method utilizes the `DataFetcher` class to fetch data related to climate change, eutrophication, air quality, and protein output.</span>
<span class="sd">        - It then combines the fetched data into a dictionary containing the scenario and relevant values for ranking, percentage changes in</span>
<span class="sd">        greenhouse gas emissions, ammonia emissions, eutrophication emissions, and protein output from the baseline.</span>
<span class="sd">        - The scatter plot is generated with each scenario&#39;s rank on the x-axis and the percentage change in the specified variable on the y-axis.</span>
<span class="sd">        - The plot includes multiple scatter plots, each representing one of the selected variables (e.g., gas emissions, eutrophication,</span>
<span class="sd">        ammonia, and protein output) to compare changes across different scenarios.</span>
<span class="sd">        - The scenarios are displayed on the secondary x-axis (ax2) with their corresponding ranks.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fetch_class</span> <span class="o">=</span> <span class="n">DataFetcher</span><span class="p">()</span>

        <span class="n">climate</span> <span class="o">=</span> <span class="n">fetch_class</span><span class="o">.</span><span class="n">get_climate_change_emission_totals</span><span class="p">()</span>
        <span class="n">eutrophication</span> <span class="o">=</span> <span class="n">fetch_class</span><span class="o">.</span><span class="n">get_eutrophication_emission_totals</span><span class="p">()</span>
        <span class="n">air</span> <span class="o">=</span> <span class="n">fetch_class</span><span class="o">.</span><span class="n">get_air_quality_emission_totals</span><span class="p">()</span>
        <span class="n">products</span> <span class="o">=</span> <span class="n">fetch_class</span><span class="o">.</span><span class="n">get_livestock_output_summary</span><span class="p">()</span>

        <span class="n">emission_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;climate_change&quot;</span><span class="p">:</span> <span class="n">climate</span><span class="p">,</span>
            <span class="s2">&quot;air_quality&quot;</span><span class="p">:</span> <span class="n">air</span><span class="p">,</span>
            <span class="s2">&quot;eutrophication&quot;</span><span class="p">:</span> <span class="n">eutrophication</span><span class="p">,</span>
            <span class="s2">&quot;protein_output&quot;</span><span class="p">:</span> <span class="n">products</span><span class="p">,</span>
        <span class="p">}</span>



        <span class="n">filter_class</span> <span class="o">=</span> <span class="n">FilterResults</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">gas</span><span class="p">,</span> <span class="n">emission_dict</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">filter_class</span><span class="o">.</span><span class="n">search</span><span class="p">()</span>

        <span class="n">rank</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;rank&quot;</span><span class="p">]</span>

        <span class="n">gas_percent</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;gas_change&quot;</span><span class="p">]</span>

        <span class="n">eutrophication_percent</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">v</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;eutrophication_change&quot;</span>
        <span class="p">]</span>

        <span class="n">ammonia_percent</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">v</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;ammonia_change&quot;</span>
        <span class="p">]</span>

        <span class="n">production_percent</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">v</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;production_cost&quot;</span>
        <span class="p">]</span>

        <span class="c1"># Stem plot</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="c1"># Scatter plot for gas_percent</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">first_element_value</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">rank</span><span class="p">,</span>
            <span class="n">gas_percent</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">first_element_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gas&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> Percentage Change&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Scatter plot for eutrophication_percent</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">rank</span><span class="p">,</span>
            <span class="n">eutrophication_percent</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Eutrophication Percentage Change&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Scatter plot for ammonia_percent</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rank</span><span class="p">,</span> <span class="n">ammonia_percent</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ammonia Percentage Change&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">rank</span><span class="p">,</span> <span class="n">production_percent</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Protein Percentage Change&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span>
            <span class="n">rank</span><span class="p">,</span>
            <span class="n">ymin</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">ymax</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
            <span class="n">linestyles</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Add x and y axis labels</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Rank&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Percentage&quot;</span><span class="p">)</span>

        <span class="n">scenarios</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">scenarios</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">360</span><span class="p">)</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Scenarios&quot;</span><span class="p">)</span>

        <span class="c1"># Dummy plot on ax2</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[])</span>

        <span class="c1"># Add legend to the plot</span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">handles2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">handles</span> <span class="o">+</span> <span class="n">handles2</span><span class="p">,</span>
            <span class="n">labels</span> <span class="o">+</span> <span class="n">labels2</span><span class="p">,</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;scenario_rank_chart.png&quot;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Colm Duffy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>